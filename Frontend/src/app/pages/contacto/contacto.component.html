<main>
  <div class="container my-5">
    <div class="card p-4 shadow">
      <div class="card-header">
        <h2 class="card-title">Contáctanos</h2>
        <p class="card-description text-secondary">
          Complete el formulario a continuación para ponerse en contacto. ¡Nos encantaría saber de ti!
        </p>
      </div>
      <div class="card-body">
        <form [formGroup]="contactForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>

          <div class="mb-3">
            <label for="name" class="form-label">Nombre</label>
            <input id="name" type="text" formControlName="nombre" placeholder="Tu Nombre"
              class="form-control"
              [class.is-invalid]="nombre?.invalid && (nombre?.dirty || nombre?.touched)"
              [class.is-valid]="nombre?.valid && (nombre?.dirty || nombre?.touched)">

            @if (nombre?.invalid && (nombre?.dirty || nombre?.touched)) {
              <div class="invalid-feedback">
                @if (nombre?.errors?.['required']) {
                  <div>El nombre es requerido.</div>
                }
                @if (nombre?.errors?.['minlength']) {
                  <div>Debe tener al menos 2 caracteres.</div>
                }
                @if (nombre?.errors?.['maxlength']) {
                  <div>Debe tener como máximo 100 caracteres.</div>
                }
              </div>
            }

            @if (nombre?.valid && (nombre?.dirty || nombre?.touched)) {
              <div class="valid-feedback">¡Correcto!</div>
            }
          </div>

          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input id="email" type="email" formControlName="email" placeholder="tu.correo@ejemplo.com"
              class="form-control"
              [class.is-invalid]="email?.invalid && (email?.dirty || email?.touched)"
              [class.is-valid]="email?.valid && (email?.dirty || email?.touched)">

            @if (email?.invalid && (email?.dirty || email?.touched)) {
              <div class="invalid-feedback">
                @if (email?.errors?.['required']) {
                  <div>El email es requerido.</div>
                }
                @if (email?.errors?.['email']) {
                  <div>Email inválido.</div>
                }
              </div>
            }

            @if (email?.valid && (email?.dirty || email?.touched)) {
              <div class="valid-feedback">¡Correcto!</div>
            }
          </div>

          <div class="mb-3">
            <label for="subject" class="form-label">Asunto</label>
            <input id="subject" type="text" formControlName="asunto" placeholder="Asunto del mensaje"
              class="form-control"
              [class.is-invalid]="asunto?.invalid && (asunto?.dirty || asunto?.touched)"
              [class.is-valid]="asunto?.valid && (asunto?.dirty || asunto?.touched)">

            @if (asunto?.invalid && (asunto?.dirty || asunto?.touched)) {
              <div class="invalid-feedback">
                @if (asunto?.errors?.['required']) {
                  <div>El asunto es requerido.</div>
                }
                @if (asunto?.errors?.['maxlength']) {
                  <div>Máximo 150 caracteres.</div>
                }
              </div>
            }

            @if (asunto?.valid && (asunto?.dirty || asunto?.touched)) {
              <div class="valid-feedback">¡Correcto!</div>
            }
          </div>

          <div class="mb-3">
            <label for="message" class="form-label">Mensaje</label>
            <textarea id="message" formControlName="mensaje" rows="4"
              placeholder="Escribe tu mensaje aquí..."
              class="form-control"
              [class.is-invalid]="mensaje?.invalid && (mensaje?.dirty || mensaje?.touched)"
              [class.is-valid]="mensaje?.valid && (mensaje?.dirty || mensaje?.touched)">
            </textarea>

            @if (mensaje?.invalid && (mensaje?.dirty || mensaje?.touched)) {
              <div class="invalid-feedback">
                @if (mensaje?.errors?.['required']) {
                  <div>Se requiere un mensaje.</div>
                }
                @if (mensaje?.errors?.['minlength']) {
                  <div>Debe tener al menos 10 caracteres.</div>
                }
                @if (mensaje?.errors?.['maxlength']) {
                  <div>Máximo 1000 caracteres.</div>
                }
              </div>
            }

            @if (mensaje?.valid && (mensaje?.dirty || mensaje?.touched)) {
              <div class="valid-feedback">¡Correcto!</div>
            }
          </div>

          @if (submissionMessage) {
            <div class="alert alert-success mt-3" role="alert">{{ submissionMessage }}</div>
          }
          @if (submissionError) {
            <div class="alert alert-danger mt-3" role="alert">{{ submissionError }}</div>
          }

          <button type="submit" class="btn btn-submit" class="btn btn-primary mt-3" [disabled]="isLoading || contactForm.invalid">
            @if (isLoading) {
              <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            }
            Enviar Mensaje
          </button>

        </form>
      </div>
    </div>
  </div>
</main>